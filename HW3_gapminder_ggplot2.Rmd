---
title: "Explorating ggplot2"
author: "Santina"
date: "Monday, September 29, 2014"
output: html_document
---

In this R markdown I'm going to try out some ggplot2 features I just learned from Prof. Jenny Bryan's [tutorial](https://github.com/jennybc/ggplot2-tutorial) on the [gapminder data](http://www.stat.ubc.ca/~jenny/notOcto/STAT545A/examples/gapminder/data/gapminderDataFiveYear.txt) like in the last Rmd assignment. 

First let's see what variables we can play with: 

```{r }
#load ggplot2 and dplyr, which we will used later
library(ggplot2) 
suppressPackageStartupMessages(library(dplyr))
#load gapminder data 
data  <- read.delim("gapminderDataFiveYear.txt")
str(data)
```

So we have country, continent, pop (population), gdpPercap, lifeExp, and year. That's plenty to work with. Since lifeExp has been explored quite throroughly in the tutorial, I'll focus on other variables. 

Also, there are only 2 countries in Oceania so I will exclude them from further analysis. 

```{r}
data  <- subset(data, continent != "Oceania")
```

#Population Boom
I'm interested to find out the trend of the population growth globally 

So we need to break down the problem step by step.  
- sum population of all countries by year 
- construct a smooth histogram 

##Global Population
Sounds like a daunting task... take a moment to think what'd be a smart way to sum population by continent? 
...
Ans: use the %>% to pipe and filter and summarize! 
```{r}
population_year  <-  data %>% group_by(year) %>% summarize(million = sum(pop)/1000000) 

head(population_year, 10)
```

Now we graph it 
```{r}
ggplot(data=population_year, aes(x=year, y=million)) + geom_histogram(stat="identity", alpha=0.5)

```

Note that we need to specify `stat = "identity"` because we have pre-tabulated, i.e. the heights (population in millions) are already calculated. 

## Population by Continent 
Let's try adding more information, supposed we want to see how much each continent contributes to the total population... 

```{r}
#create a new data.frame with total population sorted by year and continent
population_continent  <-  data %>% group_by(year, continent) %>% summarize(million = sum(pop)/1000000) 

#make a smooth graph, color by continent
ggplot(data=population_continent, aes(x = year, y = million, fill = continent)) + geom_density(stat="identity", alpha=0.4)

```

Looks like Asia contributes to the most... to double check, let's use a bit more R trick 

```{r}
population_continent  %>% filter(continent=="Asia")  %>% arrange(desc(year))

```

Indeed we see that in 2007 the population in Asia was close to 4000 millions. 


